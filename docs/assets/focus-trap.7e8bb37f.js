import{a3 as A,aG as se,u as re,c as Z,k as v,aH as ae,r as m,aI as ce,o as R,a as B,q as D,a2 as ee,l as ue,p as ie,w as F,_ as de,L as V,ac as le,O as fe}from"./index.37164a17.js";import{i as pe}from"./button.ebcc8145.js";const Ee='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',ve=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,xe=e=>Array.from(e.querySelectorAll(Ee)).filter(t=>me(t)&&ve(t)),me=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},Ke=function(e,t,...o){let s;t.includes("mouse")||t.includes("click")?s="MouseEvents":t.includes("key")?s="KeyboardEvent":s="HTMLEvents";const a=document.createEvent(s);return a.initEvent(t,...o),e.dispatchEvent(a),e};var Te=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Te||{});const G=e=>{const t=A(e)?e:[e],o=[];return t.forEach(s=>{A(s)?o.push(...G(s)):se(s)&&A(s.children)?o.push(...G(s.children)):o.push(s)}),o};var be={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const Se=e=>(t,o)=>ye(t,o,v(e)),ye=(e,t,o)=>ce(o,e,e).replace(/\{(\w+)\}/g,(s,a)=>{var c;return`${(c=t==null?void 0:t[a])!=null?c:`{${a}}`}`}),he=e=>{const t=Z(()=>v(e).name),o=ae(e)?e:m(e);return{lang:t,locale:o,t:Se(e)}},Ye=()=>{const e=re("locale");return he(Z(()=>e.value||be))};let E=[];const $=e=>{const t=e;t.key===ee.esc&&E.forEach(o=>o(t))},Le=e=>{R(()=>{E.length===0&&document.addEventListener("keydown",$),B&&E.push(e)}),D(()=>{E=E.filter(t=>t!==e),E.length===0&&B&&document.removeEventListener("keydown",$)})},g="focus-trap.focus-after-trapped",O="focus-trap.focus-after-released",Ne="focus-trap.focusout-prevented",J={cancelable:!0,bubbles:!1},_e={cancelable:!0,bubbles:!1},j="focusAfterTrapped",W="focusAfterReleased",Ce=Symbol("elFocusTrap"),k=m(),L=m(0),I=m(0);let S=0;const te=e=>{const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)t.push(o.currentNode);return t},q=(e,t)=>{for(const o of e)if(!we(o,t))return o},we=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Ae=e=>{const t=te(e),o=q(t,e),s=q(t.reverse(),e);return[o,s]},Fe=e=>e instanceof HTMLInputElement&&"select"in e,f=(e,t)=>{if(e&&e.focus){const o=document.activeElement;e.focus({preventScroll:!0}),I.value=window.performance.now(),e!==o&&Fe(e)&&t&&e.select()}};function X(e,t){const o=[...e],s=e.indexOf(t);return s!==-1&&o.splice(s,1),o}const ge=()=>{let e=[];return{push:s=>{const a=e[0];a&&s!==a&&a.pause(),e=X(e,s),e.unshift(s)},remove:s=>{var a,c;e=X(e,s),(c=(a=e[0])==null?void 0:a.resume)==null||c.call(a)}}},Oe=(e,t=!1)=>{const o=document.activeElement;for(const s of e)if(f(s,t),document.activeElement!==o)return},z=ge(),Re=()=>L.value>I.value,y=()=>{k.value="pointer",L.value=window.performance.now()},Q=()=>{k.value="keyboard",L.value=window.performance.now()},De=()=>(R(()=>{S===0&&(document.addEventListener("mousedown",y),document.addEventListener("touchstart",y),document.addEventListener("keydown",Q)),S++}),D(()=>{S--,S<=0&&(document.removeEventListener("mousedown",y),document.removeEventListener("touchstart",y),document.removeEventListener("keydown",Q))}),{focusReason:k,lastUserFocusTimestamp:L,lastAutomatedFocusTimestamp:I}),h=e=>new CustomEvent(Ne,{..._e,detail:e}),ke=ue({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[j,W,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const o=m();let s,a;const{focusReason:c}=De();Le(n=>{e.trapped&&!p.paused&&t("release-requested",n)});const p={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},T=n=>{if(!e.loop&&!e.trapped||p.paused)return;const{key:r,altKey:u,ctrlKey:i,metaKey:d,currentTarget:K,shiftKey:Y}=n,{loop:H}=e,oe=r===ee.tab&&!u&&!i&&!d,b=document.activeElement;if(oe&&b){const _=K,[C,w]=Ae(_);if(C&&w){if(!Y&&b===w){const l=h({focusReason:c.value});t("focusout-prevented",l),l.defaultPrevented||(n.preventDefault(),H&&f(C,!0))}else if(Y&&[C,_].includes(b)){const l=h({focusReason:c.value});t("focusout-prevented",l),l.defaultPrevented||(n.preventDefault(),H&&f(w,!0))}}else if(b===_){const l=h({focusReason:c.value});t("focusout-prevented",l),l.defaultPrevented||n.preventDefault()}}};ie(Ce,{focusTrapRef:o,onKeydown:T}),F(()=>e.focusTrapEl,n=>{n&&(o.value=n)},{immediate:!0}),F([o],([n],[r])=>{n&&(n.addEventListener("keydown",T),n.addEventListener("focusin",M),n.addEventListener("focusout",P)),r&&(r.removeEventListener("keydown",T),r.removeEventListener("focusin",M),r.removeEventListener("focusout",P))});const N=n=>{t(j,n)},ne=n=>t(W,n),M=n=>{const r=v(o);if(!r)return;const u=n.target,i=n.relatedTarget,d=u&&r.contains(u);e.trapped||i&&r.contains(i)||(s=i),d&&t("focusin",n),!p.paused&&e.trapped&&(d?a=u:f(a,!0))},P=n=>{const r=v(o);if(!(p.paused||!r))if(e.trapped){const u=n.relatedTarget;!pe(u)&&!r.contains(u)&&setTimeout(()=>{if(!p.paused&&e.trapped){const i=h({focusReason:c.value});t("focusout-prevented",i),i.defaultPrevented||f(a,!0)}},0)}else{const u=n.target;u&&r.contains(u)||t("focusout",n)}};async function U(){await V();const n=v(o);if(n){z.push(p);const r=n.contains(document.activeElement)?s:document.activeElement;if(s=r,!n.contains(r)){const i=new Event(g,J);n.addEventListener(g,N),n.dispatchEvent(i),i.defaultPrevented||V(()=>{let d=e.focusStartEl;le(d)||(f(d),document.activeElement!==d&&(d="first")),d==="first"&&Oe(te(n),!0),(document.activeElement===r||d==="container")&&f(n)})}}}function x(){const n=v(o);if(n){n.removeEventListener(g,N);const r=new CustomEvent(O,{...J,detail:{focusReason:c.value}});n.addEventListener(O,ne),n.dispatchEvent(r),!r.defaultPrevented&&(c.value=="keyboard"||!Re())&&f(s!=null?s:document.body,!0),n.removeEventListener(O,N),z.remove(p)}}return R(()=>{e.trapped&&U(),F(()=>e.trapped,n=>{n?U():x()})}),D(()=>{e.trapped&&x()}),{onKeydown:T}}});function Ie(e,t,o,s,a,c){return fe(e.$slots,"default",{handleKeydown:e.onKeydown})}var He=de(ke,[["render",Ie],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);export{He as E,Ce as F,Te as P,G as f,xe as o,Ke as t,Ye as u};
