import{p as N,s as D}from"./element-plus-BFcDWg1f.js";import{r as d,I as H,h as U,o as P,c as C,a as y,M as c,Q as w,U as _}from"./@vue-MCHm96jj.js";import{u as A,b as Q}from"./vue-router-eHBfJRM6.js";import{u as j}from"./index-BSkCN0c1.js";import{_ as q}from"./plugin-vue_export-helper-DlAUqK2U.js";import"./lodash-es-Rc7wuZoG.js";import"./async-validator-DKvM95Vc.js";import"./@vueuse-BBkpAsxl.js";import"./@element-plus-BwAoTnwU.js";import"./@ctrl-r5W6hzzQ.js";import"./@popperjs-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-C7Q_MLg3.js";import"./pinia-plugin-persist-J3Q2VqHx.js";import"./lazysizes-DIA6Q0hx.js";const z={class:"whiteboard-box"},F={class:"whiteboard-btns"},G={__name:"WhiteBoard",props:{},setup(T){const b=d(),n=d(),o=d(),v=d(),a=d(),r=d("paint");function f(e){r.value=e,["rect","ellipse","arrow"].includes(e)?o.value.style.display="block":o.value.style.display="none"}const i=H({lineWidth:1.5,color:"#ff0000",eraserWidth:20}),x=d(["#ff0000","#0000ff"]);function I(){v.value=n.value.getContext("2d"),a.value=o.value.getContext("2d");let e=n.value.parentNode.clientWidth,t=n.value.parentNode.clientHeight,l=window.devicePixelRatio||1;n.value.width=Math.round(e*l),n.value.height=Math.round(t*l),n.value.style.width=e+"px",n.value.style.height=t+"px",o.value.width=Math.round(e*l),o.value.height=Math.round(t*l),o.value.style.width=e+"px",o.value.style.height=t+"px",v.value.scale(l,l),a.value.scale(l,l)}U(()=>{I()});const h=d(0),p=d(0),M=d(!1);function k(e){M.value=!0,h.value=e.offsetX,p.value=e.offsetY}function W(e){M.value&&(r.value=="paint"?(R(h.value,p.value,e.offsetX,e.offsetY),h.value=e.offsetX,p.value=e.offsetY):r.value=="eraser"?v.value.clearRect(e.offsetX-.5*i.eraserWidth,e.offsetY-.5*i.eraserWidth,i.eraserWidth,i.eraserWidth):r.value=="rect"?X(h.value,p.value,e.offsetX-h.value,e.offsetY-p.value):r.value=="ellipse"?Y(h.value,p.value,e.offsetX,e.offsetY):r.value=="arrow"&&E(h.value,p.value,e.offsetX,e.offsetY))}function g(){["rect","ellipse","arrow"].includes(r.value)&&S(),M.value=!1}function R(e,t,l,s){v.value.beginPath(),v.value.moveTo(e,t),v.value.lineTo(l,s),v.value.lineWidth=i.lineWidth,v.value.strokeStyle=i.color,v.value.stroke()}function X(e,t,l,s){a.value.clearRect(0,0,o.value.width,o.value.height),a.value.beginPath(),a.value.lineWidth=i.lineWidth,a.value.strokeStyle=i.color,a.value.rect(e,t,l,s),a.value.stroke()}function Y(e,t,l,s){a.value.clearRect(0,0,o.value.width,o.value.height),a.value.beginPath(),a.value.lineWidth=i.lineWidth,a.value.strokeStyle=i.color,a.value.ellipse(e+Math.abs(l-e)/2,t+Math.abs(s-t)/2,Math.abs(l-e),Math.abs(s-t),0,0,Math.PI*2,!1),a.value.stroke()}function E(e,t,l,s){a.value.clearRect(0,0,o.value.width,o.value.height),a.value.beginPath(),a.value.moveTo(e,t),a.value.lineTo(l,s),a.value.lineWidth=i.lineWidth,a.value.strokeStyle=i.color,a.value.stroke();let u=Math.atan2(s-t,l-e),m=parseInt(i.lineWidth*7,10),B=l+.5*m*Math.cos(u),V=s+.5*m*Math.sin(u);a.value.beginPath(),a.value.moveTo(B,V),a.value.lineTo(l-m*Math.cos(u-Math.PI/6),s-m*Math.sin(u-Math.PI/6)),a.value.lineTo(l-m*Math.cos(u+Math.PI/6),s-m*Math.sin(u+Math.PI/6)),a.value.closePath(),a.value.fillStyle=i.color,a.value.fill()}function S(){let e=parseInt(n.value.style.width,10),t=parseInt(n.value.style.height,10);v.value.drawImage(o.value,0,0,o.value.width,o.value.height,0,0,e,t),a.value.clearRect(0,0,o.value.width,o.value.height)}function $(){v.value.clearRect(0,0,n.value.width,n.value.height),r.value=="eraser"&&f("paint")}return(e,t)=>{const l=N,s=D;return P(),C("div",z,[y("div",F,[c(l,{type:r.value=="paint"?"primary":"",onClick:t[0]||(t[0]=u=>f("paint"))},{default:w(()=>[_("画笔")]),_:1},8,["type"]),c(l,{type:r.value=="rect"?"primary":"",onClick:t[1]||(t[1]=u=>f("rect"))},{default:w(()=>[_("矩形")]),_:1},8,["type"]),c(l,{type:r.value=="ellipse"?"primary":"",onClick:t[2]||(t[2]=u=>f("ellipse"))},{default:w(()=>[_("椭圆")]),_:1},8,["type"]),c(l,{type:r.value=="arrow"?"primary":"",onClick:t[3]||(t[3]=u=>f("arrow"))},{default:w(()=>[_("箭头")]),_:1},8,["type"]),c(s,{modelValue:i.color,"onUpdate:modelValue":t[4]||(t[4]=u=>i.color=u),predefine:x.value},null,8,["modelValue","predefine"]),c(l,{type:r.value=="eraser"?"primary":"",onClick:t[5]||(t[5]=u=>f("eraser"))},{default:w(()=>[_("橡皮擦")]),_:1},8,["type"]),c(l,{type:"",onClick:$},{default:w(()=>[_("清空")]),_:1})]),y("div",{ref_key:"boardEl",ref:b,class:"whiteboard"},[y("canvas",{ref_key:"canvas",ref:n,class:"whiteboard-canvas",width:"",height:"",onMousedown:k,onMousemove:W,onMouseup:g,onMouseleave:g},null,544),y("canvas",{ref_key:"canvasTemp",ref:o,class:"whiteboard-temp",style:{display:"none"},width:"",height:"",onMousedown:k,onMousemove:W,onMouseup:g,onMouseleave:g},null,544)],512)])}}},J={class:"page-box"},K={__name:"index",setup(T){return A(),Q(),j(),(b,n)=>{const o=G;return P(),C("div",J,[c(o,{class:"my-whiteboard"})])}}},ce=q(K,[["__scopeId","data-v-d36239be"]]);export{ce as default};
