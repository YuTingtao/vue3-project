import{A as v,R as A,$ as D,o as j,j as z,k as g,a as c,w,a0 as C,a1 as P,H as F,X as G,a2 as U,C as y}from"./vender-SVA87YeA.js";const q={class:"whiteboard-box"},J={class:"whiteboard-btns"},K={class:"whiteboard"},Q={__name:"index",setup(L){const u=v(),i=v(),s=v(),o=v(),t=A({drawType:"paint",lineWidth:1.5,color:"#ff0000",eraserWidth:20});function h(e){t.drawType=e}const X=v(["#ff0000","#0000ff"]);function Y(){s.value=u.value.getContext("2d"),o.value=i.value.getContext("2d");let e=u.value.parentNode.clientWidth,a=u.value.parentNode.clientHeight,l=window.devicePixelRatio||1;u.value.width=Math.round(e*l),u.value.height=Math.round(a*l),u.value.style.width=e+"px",u.value.style.height=a+"px",i.value.width=Math.round(e*l),i.value.height=Math.round(a*l),i.value.style.width=e+"px",i.value.style.height=a+"px",s.value.scale(l,l),o.value.scale(l,l)}D(()=>{Y()});const d=v(0),f=v(0),k=v(0),x=v(0),T=v(!1),m=v(!1),b=v();function W(e){t.drawType!="text"?(T.value=!0,d.value=e.offsetX,f.value=e.offsetY):m.value||(m.value=!0,d.value=e.offsetX,f.value=e.offsetY,k.value=e.pageX,x.value=e.pageY,setTimeout(()=>{b.value.focus()},20))}function _(e){T.value&&(t.drawType=="paint"?(R(d.value,f.value,e.offsetX,e.offsetY),d.value=e.offsetX,f.value=e.offsetY):t.drawType=="eraser"?s.value.clearRect(e.offsetX-.5*t.eraserWidth,e.offsetY-.5*t.eraserWidth,t.eraserWidth,t.eraserWidth):t.drawType=="rect"?S(d.value,f.value,e.offsetX-d.value,e.offsetY-f.value):t.drawType=="ellipse"?I(d.value,f.value,e.offsetX,e.offsetY):t.drawType=="arrow"&&H(d.value,f.value,e.offsetX,e.offsetY))}function M(){T.value&&(["rect","ellipse","arrow"].includes(t.drawType)&&$(),T.value=!1)}function R(e,a,l,n){s.value.beginPath(),s.value.moveTo(e,a),s.value.lineTo(l,n),s.value.lineWidth=t.lineWidth,s.value.strokeStyle=t.color,s.value.stroke()}function S(e,a,l,n){o.value.clearRect(0,0,i.value.width,i.value.height),o.value.beginPath(),o.value.lineWidth=t.lineWidth,o.value.strokeStyle=t.color,o.value.rect(e,a,l,n),o.value.stroke()}function I(e,a,l,n){o.value.clearRect(0,0,i.value.width,i.value.height),o.value.beginPath(),o.value.lineWidth=t.lineWidth,o.value.strokeStyle=t.color,o.value.ellipse(e+Math.abs(l-e)/2,a+Math.abs(n-a)/2,Math.abs(l-e),Math.abs(n-a),0,0,Math.PI*2,!1),o.value.stroke()}function H(e,a,l,n){o.value.clearRect(0,0,i.value.width,i.value.height),o.value.beginPath(),o.value.moveTo(e,a),o.value.lineTo(l,n),o.value.lineWidth=t.lineWidth,o.value.strokeStyle=t.color,o.value.stroke();let r=Math.atan2(n-a,l-e),p=parseInt(t.lineWidth*7,10),N=l+.5*p*Math.cos(r),V=n+.5*p*Math.sin(r);o.value.beginPath(),o.value.moveTo(N,V),o.value.lineTo(l-p*Math.cos(r-Math.PI/6),n-p*Math.sin(r-Math.PI/6)),o.value.lineTo(l-p*Math.cos(r+Math.PI/6),n-p*Math.sin(r+Math.PI/6)),o.value.closePath(),o.value.fillStyle=t.color,o.value.fill()}function $(){let e=parseInt(u.value.style.width,10),a=parseInt(u.value.style.height,10);s.value.drawImage(i.value,0,0,i.value.width,i.value.height,0,0,e,a),o.value.clearRect(0,0,i.value.width,i.value.height)}function B(e){e.target.innerText.split(/\n\r|\n/).forEach((l,n)=>{s.value.fillStyle=t.color,s.value.font='14px "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif';let r=d.value+9,p=f.value-14+(n+1)*20;s.value.fillText(l,r,p)}),e.target.innerText="",m.value=!1}function E(){s.value.clearRect(0,0,u.value.width,u.value.height),t.drawType=="eraser"&&h("paint")}return(e,a)=>{const l=G,n=U;return j(),z("div",q,[g("div",J,[c(l,{type:t.drawType=="paint"?"primary":"",onClick:a[0]||(a[0]=r=>h("paint"))},{default:w(()=>[y(" 画笔 ")]),_:1},8,["type"]),c(l,{type:t.drawType=="rect"?"primary":"",onClick:a[1]||(a[1]=r=>h("rect"))},{default:w(()=>[y(" 矩形 ")]),_:1},8,["type"]),c(l,{type:t.drawType=="ellipse"?"primary":"",onClick:a[2]||(a[2]=r=>h("ellipse"))},{default:w(()=>[y(" 椭圆 ")]),_:1},8,["type"]),c(l,{type:t.drawType=="arrow"?"primary":"",onClick:a[3]||(a[3]=r=>h("arrow"))},{default:w(()=>[y(" 箭头 ")]),_:1},8,["type"]),c(l,{type:t.drawType=="text"?"primary":"",onClick:a[4]||(a[4]=r=>h("text"))},{default:w(()=>[y(" 文本 ")]),_:1},8,["type"]),c(n,{modelValue:t.color,"onUpdate:modelValue":a[5]||(a[5]=r=>t.color=r),predefine:X.value},null,8,["modelValue","predefine"]),c(l,{type:t.drawType=="eraser"?"primary":"",onClick:a[6]||(a[6]=r=>h("eraser"))},{default:w(()=>[y(" 橡皮擦 ")]),_:1},8,["type"]),c(l,{style:{"margin-left":"36px"},type:"",onClick:E},{default:w(()=>[y("清空")]),_:1})]),g("div",K,[g("canvas",{ref_key:"canvas",ref:u,class:"whiteboard-canvas",width:"",height:"",onMousedown:W,onMousemove:_,onMouseup:M,onMouseleave:M},null,544),C(g("canvas",{ref_key:"canvasTemp",ref:i,class:"whiteboard-temp",width:"",height:"",onMousedown:W,onMousemove:_,onMouseup:M,onMouseleave:M},null,544),[[P,["rect","ellipse","arrow"].includes(t.drawType)]]),C(g("div",{ref_key:"inputRef",ref:b,class:"whiteboard-input",contenteditable:"true",style:F({color:t.color,left:k.value+"px",top:x.value-16+"px"}),onBlur:B},null,36),[[P,t.drawType=="text"&&m.value]])])])}}};export{Q as default};
