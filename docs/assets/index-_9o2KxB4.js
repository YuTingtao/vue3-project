import{a as i}from"./axios-B4uVmeYG.js";import{u as n,r as s}from"./index-NwVkuVvx.js";import{q as r}from"./element-plus-xzLfkKtZ.js";function o(t){r.closeAll(),r.error({message:t,duration:2e3})}function u(){const t=s.currentRoute;let e="/login";t.value.path!="/login"&&(e=`/login?redirect=${t.value.fullPath}`),s.push(e)}const a=i.create({});a.interceptors.request.use(t=>{const e=n();return t.headers["Content-Type"]="application/json",e.token&&(t.headers.token=e.token),t},t=>(console.log(t),Promise.reject(t)));a.interceptors.response.use(t=>{const e=n();if(t.status>=200&&t.status<300){if(t.data instanceof Blob||t.data instanceof ArrayBuffer)return t;if(t.data.code=="200")return t.data;if(t.data.code=="000001")o(t.data.msg),e.setLogout(),u();else return o(t.data.msg||"网络异常"),Promise.reject(t.data)}else return Promise.reject(t)},t=>{if(t.response){switch(t.response.status){case 404:o("网络请求不存在");break;default:o("网络异常")}return Promise.reject(t)}else navigator.onLine||o("设备已断开网络")});const d={login(t){return a.request({url:"/api/login",method:"post",data:t,timeout:500})},logout(){return a.request({url:"/api/logout",method:"get"})}};export{d as l};
