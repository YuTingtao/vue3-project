import{a as fe}from"./axios-upsvKRUO.js";import{b as J,d as k,e as L,u as me,f as m,i as w,h as H,o as v,j as I,q as _,N as O,m as N,aa as K,A as x,s as h,k as o,n as W,al as ge,B as Y,ab as ee,T as se,_ as te,t as ye,a as ve,ad as he,at as oe,au as Ce,av as be,r as z,aw as F,y as Te,w as we,L as Se,aj as Be,l as b,X as B,E as U,p as Ne,$ as ke,Z as $e,ax as Le,ac as Ee,Q as Me,g as V,ay as ne,H as A,az as q,aA as c,aB as ze,aC as Z,aD as Ie,ar as D,aE as G}from"./index-ZuzpkN-R.js";const _e=J({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:k([String,Object,Array])},offset:{type:k(Array),default:[0,0]},badgeClass:{type:String}}),xe=L({name:"ElBadge"}),Ae=L({...xe,props:_e,setup(e,{expose:t}){const s=e,a=me("badge"),n=m(()=>s.isDot?"":w(s.value)&&w(s.max)?s.max<s.value?`${s.max}+`:`${s.value}`:`${s.value}`),p=m(()=>{var r,u,f,g,y;return[{backgroundColor:s.color,marginRight:H(-((u=(r=s.offset)==null?void 0:r[0])!=null?u:0)),marginTop:H((g=(f=s.offset)==null?void 0:f[1])!=null?g:0)},(y=s.badgeStyle)!=null?y:{}]});return t({content:n}),(r,u)=>(v(),I("div",{class:h(o(a).b())},[_(r.$slots,"default"),O(se,{name:`${o(a).namespace.value}-zoom-in-center`,persisted:""},{default:N(()=>[K(x("sup",{class:h([o(a).e("content"),o(a).em("content",r.type),o(a).is("fixed",!!r.$slots.default),o(a).is("dot",r.isDot),o(a).is("hide-zero",!r.showZero&&s.value===0),r.badgeClass]),style:W(o(p))},[_(r.$slots,"content",{value:o(n)},()=>[ge(Y(o(n)),1)])],6),[[ee,!r.hidden&&(o(n)||r.isDot||r.$slots.content)]])]),_:3},8,["name"])],2))}});var De=te(Ae,[["__file","badge.vue"]]);const Oe=ye(De),ae=["success","info","warning","error"],i=he({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:oe?document.body:void 0}),Pe=J({customClass:{type:String,default:i.customClass},center:{type:Boolean,default:i.center},dangerouslyUseHTMLString:{type:Boolean,default:i.dangerouslyUseHTMLString},duration:{type:Number,default:i.duration},icon:{type:ve,default:i.icon},id:{type:String,default:i.id},message:{type:k([String,Object,Function]),default:i.message},onClose:{type:k(Function),default:i.onClose},showClose:{type:Boolean,default:i.showClose},type:{type:String,values:ae,default:i.type},plain:{type:Boolean,default:i.plain},offset:{type:Number,default:i.offset},zIndex:{type:Number,default:i.zIndex},grouping:{type:Boolean,default:i.grouping},repeatNum:{type:Number,default:i.repeatNum}}),Re={destroy:()=>!0},d=Ce([]),je=e=>{const t=d.findIndex(n=>n.id===e),s=d[t];let a;return t>0&&(a=d[t-1]),{current:s,prev:a}},He=e=>{const{prev:t}=je(e);return t?t.vm.exposed.bottom.value:0},Fe=(e,t)=>d.findIndex(a=>a.id===e)>0?16:t,Ue=L({name:"ElMessage"}),Ve=L({...Ue,props:Pe,emits:Re,setup(e,{expose:t}){const s=e,{Close:a}=Le,{ns:n,zIndex:p}=be("message"),{currentZIndex:r,nextZIndex:u}=p,f=z(),g=z(!1),y=z(0);let E;const le=m(()=>s.type?s.type==="error"?"danger":s.type:"info"),ie=m(()=>{const l=s.type;return{[n.bm("icon",l)]:l&&F[l]}}),P=m(()=>s.icon||F[s.type]||""),ue=m(()=>He(s.id)),R=m(()=>Fe(s.id,s.offset)+ue.value),de=m(()=>y.value+R.value),ce=m(()=>({top:`${R.value}px`,zIndex:r.value}));function M(){s.duration!==0&&({stop:E}=Ee(()=>{S()},s.duration))}function j(){E==null||E()}function S(){g.value=!1}function pe({code:l}){l===Me.esc&&S()}return Te(()=>{M(),u(),g.value=!0}),we(()=>s.repeatNum,()=>{j(),M()}),Se(document,"keydown",pe),Be(f,()=>{y.value=f.value.getBoundingClientRect().height}),t({visible:g,bottom:de,close:S}),(l,Je)=>(v(),b(se,{name:o(n).b("fade"),onBeforeLeave:l.onClose,onAfterLeave:Ke=>l.$emit("destroy"),persisted:""},{default:N(()=>[K(x("div",{id:l.id,ref_key:"messageRef",ref:f,class:h([o(n).b(),{[o(n).m(l.type)]:l.type},o(n).is("center",l.center),o(n).is("closable",l.showClose),o(n).is("plain",l.plain),l.customClass]),style:W(o(ce)),role:"alert",onMouseenter:j,onMouseleave:M},[l.repeatNum>1?(v(),b(o(Oe),{key:0,value:l.repeatNum,type:o(le),class:h(o(n).e("badge"))},null,8,["value","type","class"])):B("v-if",!0),o(P)?(v(),b(o(U),{key:1,class:h([o(n).e("icon"),o(ie)])},{default:N(()=>[(v(),b(Ne(o(P))))]),_:1},8,["class"])):B("v-if",!0),_(l.$slots,"default",{},()=>[l.dangerouslyUseHTMLString?(v(),I(ke,{key:1},[B(" Caution here, message could've been compromised, never use user's input as message "),x("p",{class:h(o(n).e("content")),innerHTML:l.message},null,10,["innerHTML"])],2112)):(v(),I("p",{key:0,class:h(o(n).e("content"))},Y(l.message),3))]),l.showClose?(v(),b(o(U),{key:2,class:h(o(n).e("closeBtn")),onClick:$e(S,["stop"])},{default:N(()=>[O(o(a))]),_:1},8,["class","onClick"])):B("v-if",!0)],46,["id"]),[[ee,g.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var qe=te(Ve,[["__file","message.vue"]]);let Ze=1;const re=e=>{const t=!e||V(e)||ne(e)||A(e)?{message:e}:e,s={...i,...t};if(!s.appendTo)s.appendTo=document.body;else if(V(s.appendTo)){let a=document.querySelector(s.appendTo);ze(a)||(a=document.body),s.appendTo=a}return q(c.grouping)&&!s.grouping&&(s.grouping=c.grouping),w(c.duration)&&s.duration===3e3&&(s.duration=c.duration),w(c.offset)&&s.offset===16&&(s.offset=c.offset),q(c.showClose)&&!s.showClose&&(s.showClose=c.showClose),s},Ge=e=>{const t=d.indexOf(e);if(t===-1)return;d.splice(t,1);const{handler:s}=e;s.close()},Qe=({appendTo:e,...t},s)=>{const a=`message_${Ze++}`,n=t.onClose,p=document.createElement("div"),r={...t,id:a,onClose:()=>{n==null||n(),Ge(y)},onDestroy:()=>{Z(null,p)}},u=O(qe,r,A(r.message)||ne(r.message)?{default:A(r.message)?r.message:()=>r.message}:null);u.appContext=s||C._context,Z(u,p),e.appendChild(p.firstElementChild);const f=u.component,y={id:a,vnode:u,vm:f,handler:{close:()=>{f.exposed.visible.value=!1}},props:u.component.props};return y},C=(e={},t)=>{if(!oe)return{close:()=>{}};const s=re(e);if(s.grouping&&d.length){const n=d.find(({vnode:p})=>{var r;return((r=p.props)==null?void 0:r.message)===s.message});if(n)return n.props.repeatNum+=1,n.props.type=s.type,n.handler}if(w(c.max)&&d.length>=c.max)return{close:()=>{}};const a=Qe(s,t);return d.push(a),a.handler};ae.forEach(e=>{C[e]=(t={},s)=>{const a=re(t);return C({...a,type:e},s)}});function Xe(e){for(const t of d)(!e||e===t.props.type)&&t.handler.close()}C.closeAll=Xe;C._context=null;const Q=Ie(C,"$message");function T(e){Q.closeAll(),Q.error({message:e,duration:2e3})}function X(){const e=G.currentRoute;let t="/login";e.value.path!="/login"&&(t=`/login?redirect=${e.value.fullPath}`),G.push(t)}const $=fe.create({baseURL:""});$.interceptors.request.use(e=>{const t=D();return e.headers["Content-Type"]="application/json",t.token&&(e.headers.token=t.token),e},e=>Promise.reject(e));$.interceptors.response.use(e=>{const t=D();return e.status===200?e.data instanceof Blob||e.data instanceof ArrayBuffer?e:(e.data.code!=="200"&&T(e.data.msg),e.data.code==="000001"&&(t.setLogout(),X()),e.data):Promise.reject(e.data)},e=>{const t=D();if(e.response)switch(e.response.status){case 401:T("请先登录"),t.setLogout(),X();break;case 404:T("网络请求不存在");break;default:T("网络异常")}else navigator.onLine||T("设备已断开网络");return Promise.reject(e)});const es={login(e){return $.request({url:"/api/login",method:"post",data:e,timeout:500})},logout(){return $.request({url:"/api/logout",method:"get"})}};export{es as l};
