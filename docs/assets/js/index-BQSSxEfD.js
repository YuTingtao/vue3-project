import{b as He,d as Be,at as je,v as Xe,aL as Te,f as F,u as le,r as w,y as oe,w as B,h as Ee,Q as K,C as de,e as j,o as I,j as D,A as E,s as M,k as s,n as O,_ as ne,aW as qe,aX as Ge,aY as ie,g as J,ai as fe,aZ as Ze,a_ as Se,z as Qe,af as Je,$ as et,ao as tt,a$ as at,V as lt,b0 as ot,b1 as nt,b2 as rt,a8 as De,x as st,l as ve,m as W,aa as ee,b3 as Pe,N,X as pe,as as it,R as be,al as X,B as Ne,F as ut,E as Ae,S as ct,ab as ce,aN as dt,Y as se,b4 as Fe,t as ht}from"./index-DaDnXjmt.js";/* empty css              *//* empty css               */import{a as ft,C as vt,E as pt}from"./index-gBFkRT7y.js";import{d as mt}from"./debounce-omfefv1X.js";import"./index-eeEQj_IO.js";const gt=He({color:{type:Be(Object),required:!0},vertical:{type:Boolean,default:!1}});let me=!1;function ae(t,l){if(!je)return;const o=function(a){var r;(r=l.drag)==null||r.call(l,a)},e=function(a){var r;document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",e),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",e),document.onselectstart=null,document.ondragstart=null,me=!1,(r=l.end)==null||r.call(l,a)},n=function(a){var r;me||(a.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",o),document.addEventListener("mouseup",e),document.addEventListener("touchmove",o),document.addEventListener("touchend",e),me=!0,(r=l.start)==null||r.call(l,a))};t.addEventListener("mousedown",n),t.addEventListener("touchstart",n,{passive:!1})}const we=t=>{let l,o;return t.type==="touchend"?(o=t.changedTouches[0].clientY,l=t.changedTouches[0].clientX):t.type.startsWith("touch")?(o=t.touches[0].clientY,l=t.touches[0].clientX):(o=t.clientY,l=t.clientX),{clientX:l,clientY:o}},bt=t=>{const l=de(),{t:o}=Xe(),e=Te(),n=Te(),a=F(()=>t.color.get("alpha")),r=F(()=>o("el.colorpicker.alphaLabel"));function f(p){var b;p.target!==e.value&&h(p),(b=e.value)==null||b.focus()}function h(p){if(!n.value||!e.value)return;const v=l.vnode.el.getBoundingClientRect(),{clientX:m,clientY:k}=we(p);if(t.vertical){let _=k-v.top;_=Math.max(e.value.offsetHeight/2,_),_=Math.min(_,v.height-e.value.offsetHeight/2),t.color.set("alpha",Math.round((_-e.value.offsetHeight/2)/(v.height-e.value.offsetHeight)*100))}else{let _=m-v.left;_=Math.max(e.value.offsetWidth/2,_),_=Math.min(_,v.width-e.value.offsetWidth/2),t.color.set("alpha",Math.round((_-e.value.offsetWidth/2)/(v.width-e.value.offsetWidth)*100))}}function d(p){const{code:b,shiftKey:v}=p,m=v?10:1;switch(b){case K.left:case K.down:p.preventDefault(),p.stopPropagation(),y(-m);break;case K.right:case K.up:p.preventDefault(),p.stopPropagation(),y(m);break}}function y(p){let b=a.value+p;b=b<0?0:b>100?100:b,t.color.set("alpha",b)}return{thumb:e,bar:n,alpha:a,alphaLabel:r,handleDrag:h,handleClick:f,handleKeydown:d}},wt=(t,{bar:l,thumb:o,handleDrag:e})=>{const n=de(),a=le("color-alpha-slider"),r=w(0),f=w(0),h=w();function d(){if(!o.value||t.vertical)return 0;const $=n.vnode.el,C=t.color.get("alpha");return $?Math.round(C*($.offsetWidth-o.value.offsetWidth/2)/100):0}function y(){if(!o.value)return 0;const $=n.vnode.el;if(!t.vertical)return 0;const C=t.color.get("alpha");return $?Math.round(C*($.offsetHeight-o.value.offsetHeight/2)/100):0}function p(){if(t.color&&t.color.value){const{r:$,g:C,b:R}=t.color.toRgb();return`linear-gradient(to right, rgba(${$}, ${C}, ${R}, 0) 0%, rgba(${$}, ${C}, ${R}, 1) 100%)`}return""}function b(){r.value=d(),f.value=y(),h.value=p()}oe(()=>{if(!l.value||!o.value)return;const $={drag:C=>{e(C)},end:C=>{e(C)}};ae(l.value,$),ae(o.value,$),b()}),B(()=>t.color.get("alpha"),()=>b()),B(()=>t.color.value,()=>b());const v=F(()=>[a.b(),a.is("vertical",t.vertical)]),m=F(()=>a.e("bar")),k=F(()=>a.e("thumb")),_=F(()=>({background:h.value})),V=F(()=>({left:Ee(r.value),top:Ee(f.value)}));return{rootKls:v,barKls:m,barStyle:_,thumbKls:k,thumbStyle:V,update:b}},yt="ElColorAlphaSlider",kt=j({name:yt}),Ct=j({...kt,props:gt,setup(t,{expose:l}){const o=t,{alpha:e,alphaLabel:n,bar:a,thumb:r,handleDrag:f,handleClick:h,handleKeydown:d}=bt(o),{rootKls:y,barKls:p,barStyle:b,thumbKls:v,thumbStyle:m,update:k}=wt(o,{bar:a,thumb:r,handleDrag:f});return l({update:k,bar:a,thumb:r}),(_,V)=>(I(),D("div",{class:M(s(y))},[E("div",{ref_key:"bar",ref:a,class:M(s(p)),style:O(s(b)),onClick:s(h)},null,14,["onClick"]),E("div",{ref_key:"thumb",ref:r,class:M(s(v)),style:O(s(m)),"aria-label":s(n),"aria-valuenow":s(e),"aria-orientation":_.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:s(d)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var Mt=ne(Ct,[["__file","alpha-slider.vue"]]);const _t=j({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(t){const l=le("color-hue-slider"),o=de(),e=w(),n=w(),a=w(0),r=w(0),f=F(()=>t.color.get("hue"));B(()=>f.value,()=>{b()});function h(v){v.target!==e.value&&d(v)}function d(v){if(!n.value||!e.value)return;const k=o.vnode.el.getBoundingClientRect(),{clientX:_,clientY:V}=we(v);let $;if(t.vertical){let C=V-k.top;C=Math.min(C,k.height-e.value.offsetHeight/2),C=Math.max(e.value.offsetHeight/2,C),$=Math.round((C-e.value.offsetHeight/2)/(k.height-e.value.offsetHeight)*360)}else{let C=_-k.left;C=Math.min(C,k.width-e.value.offsetWidth/2),C=Math.max(e.value.offsetWidth/2,C),$=Math.round((C-e.value.offsetWidth/2)/(k.width-e.value.offsetWidth)*360)}t.color.set("hue",$)}function y(){if(!e.value)return 0;const v=o.vnode.el;if(t.vertical)return 0;const m=t.color.get("hue");return v?Math.round(m*(v.offsetWidth-e.value.offsetWidth/2)/360):0}function p(){if(!e.value)return 0;const v=o.vnode.el;if(!t.vertical)return 0;const m=t.color.get("hue");return v?Math.round(m*(v.offsetHeight-e.value.offsetHeight/2)/360):0}function b(){a.value=y(),r.value=p()}return oe(()=>{if(!n.value||!e.value)return;const v={drag:m=>{d(m)},end:m=>{d(m)}};ae(n.value,v),ae(e.value,v),b()}),{bar:n,thumb:e,thumbLeft:a,thumbTop:r,hueValue:f,handleClick:h,update:b,ns:l}}});function $t(t,l,o,e,n,a){return I(),D("div",{class:M([t.ns.b(),t.ns.is("vertical",t.vertical)])},[E("div",{ref:"bar",class:M(t.ns.e("bar")),onClick:t.handleClick},null,10,["onClick"]),E("div",{ref:"thumb",class:M(t.ns.e("thumb")),style:O({left:t.thumbLeft+"px",top:t.thumbTop+"px"})},null,6)],2)}var Tt=ne(_t,[["render",$t],["__file","hue-slider.vue"]]);const Et=He({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:qe,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:ft.teleported,predefine:{type:Be(Array)},validateEvent:{type:Boolean,default:!0},...Ge(["ariaLabel"])}),St={[ie]:t=>J(t)||fe(t),[Ze]:t=>J(t)||fe(t),activeChange:t=>J(t)||fe(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent},Re=Symbol("colorPickerContextKey"),We=function(t,l,o){return[t,l*o/((t=(2-l)*o)<1?t:2-t)||0,t/2]},Pt=function(t){return J(t)&&t.includes(".")&&Number.parseFloat(t)===1},Nt=function(t){return J(t)&&t.includes("%")},G=function(t,l){Pt(t)&&(t="100%");const o=Nt(t);return t=Math.min(l,Math.max(0,Number.parseFloat(`${t}`))),o&&(t=Number.parseInt(`${t*l}`,10)/100),Math.abs(t-l)<1e-6?1:t%l/Number.parseFloat(l)},Ie={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},ue=t=>{t=Math.min(Math.round(t),255);const l=Math.floor(t/16),o=t%16;return`${Ie[l]||l}${Ie[o]||o}`},Le=function({r:t,g:l,b:o}){return Number.isNaN(+t)||Number.isNaN(+l)||Number.isNaN(+o)?"":`#${ue(t)}${ue(l)}${ue(o)}`},ge={A:10,B:11,C:12,D:13,E:14,F:15},U=function(t){return t.length===2?(ge[t[0].toUpperCase()]||+t[0])*16+(ge[t[1].toUpperCase()]||+t[1]):ge[t[1].toUpperCase()]||+t[1]},At=function(t,l,o){l=l/100,o=o/100;let e=l;const n=Math.max(o,.01);o*=2,l*=o<=1?o:2-o,e*=n<=1?n:2-n;const a=(o+l)/2,r=o===0?2*e/(n+e):2*l/(o+l);return{h:t,s:r*100,v:a*100}},Ve=(t,l,o)=>{t=G(t,255),l=G(l,255),o=G(o,255);const e=Math.max(t,l,o),n=Math.min(t,l,o);let a;const r=e,f=e-n,h=e===0?0:f/e;if(e===n)a=0;else{switch(e){case t:{a=(l-o)/f+(l<o?6:0);break}case l:{a=(o-t)/f+2;break}case o:{a=(t-l)/f+4;break}}a/=6}return{h:a*360,s:h*100,v:r*100}},Q=function(t,l,o){t=G(t,360)*6,l=G(l,100),o=G(o,100);const e=Math.floor(t),n=t-e,a=o*(1-l),r=o*(1-n*l),f=o*(1-(1-n)*l),h=e%6,d=[o,r,a,a,f,o][h],y=[f,o,o,r,a,a][h],p=[a,a,f,o,o,r][h];return{r:Math.round(d*255),g:Math.round(y*255),b:Math.round(p*255)}};class te{constructor(l={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const o in l)Se(l,o)&&(this[o]=l[o]);l.value?this.fromString(l.value):this.doOnChange()}set(l,o){if(arguments.length===1&&typeof l=="object"){for(const e in l)Se(l,e)&&this.set(e,l[e]);return}this[`_${l}`]=o,this.doOnChange()}get(l){return l==="alpha"?Math.floor(this[`_${l}`]):this[`_${l}`]}toRgb(){return Q(this._hue,this._saturation,this._value)}fromString(l){if(!l){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const o=(e,n,a)=>{this._hue=Math.max(0,Math.min(360,e)),this._saturation=Math.max(0,Math.min(100,n)),this._value=Math.max(0,Math.min(100,a)),this.doOnChange()};if(l.includes("hsl")){const e=l.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(n=>n!=="").map((n,a)=>a>2?Number.parseFloat(n):Number.parseInt(n,10));if(e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3){const{h:n,s:a,v:r}=At(e[0],e[1],e[2]);o(n,a,r)}}else if(l.includes("hsv")){const e=l.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(n=>n!=="").map((n,a)=>a>2?Number.parseFloat(n):Number.parseInt(n,10));e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3&&o(e[0],e[1],e[2])}else if(l.includes("rgb")){const e=l.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(n=>n!=="").map((n,a)=>a>2?Number.parseFloat(n):Number.parseInt(n,10));if(e.length===4?this._alpha=Number.parseFloat(e[3])*100:e.length===3&&(this._alpha=100),e.length>=3){const{h:n,s:a,v:r}=Ve(e[0],e[1],e[2]);o(n,a,r)}}else if(l.includes("#")){const e=l.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(e))return;let n,a,r;e.length===3?(n=U(e[0]+e[0]),a=U(e[1]+e[1]),r=U(e[2]+e[2])):(e.length===6||e.length===8)&&(n=U(e.slice(0,2)),a=U(e.slice(2,4)),r=U(e.slice(4,6))),e.length===8?this._alpha=U(e.slice(6))/255*100:(e.length===3||e.length===6)&&(this._alpha=100);const{h:f,s:h,v:d}=Ve(n,a,r);o(f,h,d)}}compare(l){return Math.abs(l._hue-this._hue)<2&&Math.abs(l._saturation-this._saturation)<1&&Math.abs(l._value-this._value)<1&&Math.abs(l._alpha-this._alpha)<1}doOnChange(){const{_hue:l,_saturation:o,_value:e,_alpha:n,format:a}=this;if(this.enableAlpha)switch(a){case"hsl":{const r=We(l,o/100,e/100);this.value=`hsla(${l}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${l}, ${Math.round(o)}%, ${Math.round(e)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${Le(Q(l,o,e))}${ue(n*255/100)}`;break}default:{const{r,g:f,b:h}=Q(l,o,e);this.value=`rgba(${r}, ${f}, ${h}, ${this.get("alpha")/100})`}}else switch(a){case"hsl":{const r=We(l,o/100,e/100);this.value=`hsl(${l}, ${Math.round(r[1]*100)}%, ${Math.round(r[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${l}, ${Math.round(o)}%, ${Math.round(e)}%)`;break}case"rgb":{const{r,g:f,b:h}=Q(l,o,e);this.value=`rgb(${r}, ${f}, ${h})`;break}default:this.value=Le(Q(l,o,e))}}}const Ft=j({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(t){const l=le("color-predefine"),{currentColor:o}=Qe(Re),e=w(a(t.colors,t.color));B(()=>o.value,r=>{const f=new te;f.fromString(r),e.value.forEach(h=>{h.selected=f.compare(h)})}),Je(()=>{e.value=a(t.colors,t.color)});function n(r){t.color.fromString(t.colors[r])}function a(r,f){return r.map(h=>{const d=new te;return d.enableAlpha=t.enableAlpha,d.format="rgba",d.fromString(h),d.selected=d.value===f.value,d})}return{rgbaColors:e,handleSelect:n,ns:l}}});function Wt(t,l,o,e,n,a){return I(),D("div",{class:M(t.ns.b())},[E("div",{class:M(t.ns.e("colors"))},[(I(!0),D(et,null,tt(t.rgbaColors,(r,f)=>(I(),D("div",{key:t.colors[f],class:M([t.ns.e("color-selector"),t.ns.is("alpha",r._alpha<100),{selected:r.selected}]),onClick:h=>t.handleSelect(f)},[E("div",{style:O({backgroundColor:r.value})},null,4)],10,["onClick"]))),128))],2)],2)}var It=ne(Ft,[["render",Wt],["__file","predefine.vue"]]);const Lt=j({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(t){const l=le("color-svpanel"),o=de(),e=w(0),n=w(0),a=w("hsl(0, 100%, 50%)"),r=F(()=>{const d=t.color.get("hue"),y=t.color.get("value");return{hue:d,value:y}});function f(){const d=t.color.get("saturation"),y=t.color.get("value"),p=o.vnode.el,{clientWidth:b,clientHeight:v}=p;n.value=d*b/100,e.value=(100-y)*v/100,a.value=`hsl(${t.color.get("hue")}, 100%, 50%)`}function h(d){const p=o.vnode.el.getBoundingClientRect(),{clientX:b,clientY:v}=we(d);let m=b-p.left,k=v-p.top;m=Math.max(0,m),m=Math.min(m,p.width),k=Math.max(0,k),k=Math.min(k,p.height),n.value=m,e.value=k,t.color.set({saturation:m/p.width*100,value:100-k/p.height*100})}return B(()=>r.value,()=>{f()}),oe(()=>{ae(o.vnode.el,{drag:d=>{h(d)},end:d=>{h(d)}}),f()}),{cursorTop:e,cursorLeft:n,background:a,colorValue:r,handleDrag:h,update:f,ns:l}}});function Vt(t,l,o,e,n,a){return I(),D("div",{class:M(t.ns.b()),style:O({backgroundColor:t.background})},[E("div",{class:M(t.ns.e("white"))},null,2),E("div",{class:M(t.ns.e("black"))},null,2),E("div",{class:M(t.ns.e("cursor")),style:O({top:t.cursorTop+"px",left:t.cursorLeft+"px"})},[E("div")],6)],6)}var Ht=ne(Lt,[["render",Vt],["__file","sv-panel.vue"]]);const Bt=j({name:"ElColorPicker"}),Xt=j({...Bt,props:Et,emits:St,setup(t,{expose:l,emit:o}){const e=t,{t:n}=Xe(),a=le("color"),{formItem:r}=at(),f=lt(),h=ot(),{inputId:d,isLabeledByFormItem:y}=nt(e,{formItemContext:r}),p=w(),b=w(),v=w(),m=w(),k=w(),_=w(),{isFocused:V,handleFocus:$,handleBlur:C}=rt(k,{beforeFocus(){return h.value},beforeBlur(c){var L;return(L=m.value)==null?void 0:L.isFocusInsideContent(c)},afterBlur(){A(!1),Z()}});let R=!0;const T=De(new te({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue})),x=w(!1),H=w(!1),z=w(""),he=F(()=>!e.modelValue&&!H.value?"transparent":P(T,e.showAlpha)),u=F(()=>!e.modelValue&&!H.value?"":T.value),i=F(()=>y.value?void 0:e.ariaLabel||n("el.colorpicker.defaultLabel")),g=F(()=>y.value?r==null?void 0:r.labelId:void 0),S=F(()=>[a.b("picker"),a.is("disabled",h.value),a.bm("picker",f.value),a.is("focused",V.value)]);function P(c,L){if(!(c instanceof te))throw new TypeError("color should be instance of _color Class");const{r:Y,g:_e,b:$e}=c.toRgb();return L?`rgba(${Y}, ${_e}, ${$e}, ${c.get("alpha")/100})`:`rgb(${Y}, ${_e}, ${$e})`}function A(c){x.value=c}const q=mt(A,100,{leading:!0});function re(){h.value||A(!0)}function ye(){q(!1),Z()}function Z(){se(()=>{e.modelValue?T.fromString(e.modelValue):(T.value="",se(()=>{H.value=!1}))})}function Ye(){h.value||q(!x.value)}function ke(){T.fromString(z.value)}function Ke(){const c=T.value;o(ie,c),o("change",c),e.validateEvent&&(r==null||r.validate("change").catch(L=>Fe())),q(!1),se(()=>{const L=new te({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue});T.compare(L)||Z()})}function Oe(){q(!1),o(ie,null),o("change",null),e.modelValue!==null&&e.validateEvent&&(r==null||r.validate("change").catch(c=>Fe())),Z()}function xe(){x.value&&(ye(),V.value&&Me())}function Ce(c){c.preventDefault(),c.stopPropagation(),A(!1),Z()}function ze(c){switch(c.code){case K.enter:case K.numpadEnter:case K.space:c.preventDefault(),c.stopPropagation(),re(),_.value.focus();break;case K.esc:Ce(c);break}}function Me(){k.value.focus()}function Ue(){k.value.blur()}return oe(()=>{e.modelValue&&(z.value=u.value)}),B(()=>e.modelValue,c=>{c?c&&c!==T.value&&(R=!1,T.fromString(c)):H.value=!1}),B(()=>[e.colorFormat,e.showAlpha],()=>{T.enableAlpha=e.showAlpha,T.format=e.colorFormat||T.format,T.doOnChange(),o(ie,T.value)}),B(()=>u.value,c=>{z.value=c,R&&o("activeChange",c),R=!0}),B(()=>T.value,()=>{!e.modelValue&&!H.value&&(H.value=!0)}),B(()=>x.value,()=>{se(()=>{var c,L,Y;(c=p.value)==null||c.update(),(L=b.value)==null||L.update(),(Y=v.value)==null||Y.update()})}),st(Re,{currentColor:u}),l({color:T,show:re,hide:ye,focus:Me,blur:Ue}),(c,L)=>(I(),ve(s(pt),{ref_key:"popper",ref:m,visible:x.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[s(a).be("picker","panel"),s(a).b("dropdown"),c.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:c.teleported,transition:`${s(a).namespace.value}-zoom-in-top`,persistent:"",onHide:Y=>A(!1)},{content:W(()=>[ee((I(),D("div",{onKeydown:Pe(Ce,["esc"])},[E("div",{class:M(s(a).be("dropdown","main-wrapper"))},[N(Tt,{ref_key:"hue",ref:p,class:"hue-slider",color:s(T),vertical:""},null,8,["color"]),N(Ht,{ref_key:"sv",ref:b,color:s(T)},null,8,["color"])],2),c.showAlpha?(I(),ve(Mt,{key:0,ref_key:"alpha",ref:v,color:s(T)},null,8,["color"])):pe("v-if",!0),c.predefine?(I(),ve(It,{key:1,ref:"predefine","enable-alpha":c.showAlpha,color:s(T),colors:c.predefine},null,8,["enable-alpha","color","colors"])):pe("v-if",!0),E("div",{class:M(s(a).be("dropdown","btns"))},[E("span",{class:M(s(a).be("dropdown","value"))},[N(s(it),{ref_key:"inputRef",ref:_,modelValue:z.value,"onUpdate:modelValue":Y=>z.value=Y,"validate-event":!1,size:"small",onKeyup:Pe(ke,["enter"]),onBlur:ke},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),N(s(be),{class:M(s(a).be("dropdown","link-btn")),text:"",size:"small",onClick:Oe},{default:W(()=>[X(Ne(s(n)("el.colorpicker.clear")),1)]),_:1},8,["class"]),N(s(be),{plain:"",size:"small",class:M(s(a).be("dropdown","btn")),onClick:Ke},{default:W(()=>[X(Ne(s(n)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[s(vt),xe]])]),default:W(()=>[E("div",ut({id:s(d),ref_key:"triggerRef",ref:k},c.$attrs,{class:s(S),role:"button","aria-label":s(i),"aria-labelledby":s(g),"aria-description":s(n)("el.colorpicker.description",{color:c.modelValue||""}),"aria-disabled":s(h),tabindex:s(h)?-1:c.tabindex,onKeydown:ze,onFocus:s($),onBlur:s(C)}),[s(h)?(I(),D("div",{key:0,class:M(s(a).be("picker","mask"))},null,2)):pe("v-if",!0),E("div",{class:M(s(a).be("picker","trigger")),onClick:Ye},[E("span",{class:M([s(a).be("picker","color"),s(a).is("alpha",c.showAlpha)])},[E("span",{class:M(s(a).be("picker","color-inner")),style:O({backgroundColor:s(he)})},[ee(N(s(Ae),{class:M([s(a).be("picker","icon"),s(a).is("icon-arrow-down")])},{default:W(()=>[N(s(ct))]),_:1},8,["class"]),[[ce,c.modelValue||H.value]]),ee(N(s(Ae),{class:M([s(a).be("picker","empty"),s(a).is("icon-close")])},{default:W(()=>[N(s(dt))]),_:1},8,["class"]),[[ce,!c.modelValue&&!H.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var Dt=ne(Xt,[["__file","color-picker.vue"]]);const Rt=ht(Dt),Yt={class:"whiteboard-box"},Kt={class:"whiteboard-btns"},Ot={class:"whiteboard"},Zt={__name:"index",setup(t){const l=w(),o=w(),e=w(),n=w(),a=De({drawType:"paint",lineWidth:1.5,color:"#ff0000",eraserWidth:20});function r(u){a.drawType=u}const f=w(["#ff0000","#0000ff"]);function h(){e.value=l.value.getContext("2d"),n.value=o.value.getContext("2d");let u=l.value.parentNode.clientWidth,i=l.value.parentNode.clientHeight,g=window.devicePixelRatio||1;l.value.width=Math.round(u*g),l.value.height=Math.round(i*g),l.value.style.width=u+"px",l.value.style.height=i+"px",o.value.width=Math.round(u*g),o.value.height=Math.round(i*g),o.value.style.width=u+"px",o.value.style.height=i+"px",e.value.scale(g,g),n.value.scale(g,g)}oe(()=>{h()});const d=w(0),y=w(0),p=w(0),b=w(0),v=w(!1),m=w(!1),k=w();function _(u){a.drawType!="text"?(v.value=!0,d.value=u.offsetX,y.value=u.offsetY):m.value||(m.value=!0,d.value=u.offsetX,y.value=u.offsetY,p.value=u.pageX,b.value=u.pageY,setTimeout(()=>{k.value.focus()},20))}function V(u){v.value&&(a.drawType=="paint"?(C(d.value,y.value,u.offsetX,u.offsetY),d.value=u.offsetX,y.value=u.offsetY):a.drawType=="eraser"?e.value.clearRect(u.offsetX-.5*a.eraserWidth,u.offsetY-.5*a.eraserWidth,a.eraserWidth,a.eraserWidth):a.drawType=="rect"?R(d.value,y.value,u.offsetX-d.value,u.offsetY-y.value):a.drawType=="ellipse"?T(d.value,y.value,u.offsetX,u.offsetY):a.drawType=="arrow"&&x(d.value,y.value,u.offsetX,u.offsetY))}function $(){v.value&&(["rect","ellipse","arrow"].includes(a.drawType)&&H(),v.value=!1)}function C(u,i,g,S){e.value.beginPath(),e.value.moveTo(u,i),e.value.lineTo(g,S),e.value.lineWidth=a.lineWidth,e.value.strokeStyle=a.color,e.value.stroke()}function R(u,i,g,S){n.value.clearRect(0,0,o.value.width,o.value.height),n.value.beginPath(),n.value.lineWidth=a.lineWidth,n.value.strokeStyle=a.color,n.value.rect(u,i,g,S),n.value.stroke()}function T(u,i,g,S){n.value.clearRect(0,0,o.value.width,o.value.height),n.value.beginPath(),n.value.lineWidth=a.lineWidth,n.value.strokeStyle=a.color,n.value.ellipse(u+Math.abs(g-u)/2,i+Math.abs(S-i)/2,Math.abs(g-u),Math.abs(S-i),0,0,Math.PI*2,!1),n.value.stroke()}function x(u,i,g,S){n.value.clearRect(0,0,o.value.width,o.value.height),n.value.beginPath(),n.value.moveTo(u,i),n.value.lineTo(g,S),n.value.lineWidth=a.lineWidth,n.value.strokeStyle=a.color,n.value.stroke();let P=Math.atan2(S-i,g-u),A=parseInt(a.lineWidth*7,10),q=g+.5*A*Math.cos(P),re=S+.5*A*Math.sin(P);n.value.beginPath(),n.value.moveTo(q,re),n.value.lineTo(g-A*Math.cos(P-Math.PI/6),S-A*Math.sin(P-Math.PI/6)),n.value.lineTo(g-A*Math.cos(P+Math.PI/6),S-A*Math.sin(P+Math.PI/6)),n.value.closePath(),n.value.fillStyle=a.color,n.value.fill()}function H(){let u=parseInt(l.value.style.width,10),i=parseInt(l.value.style.height,10);e.value.drawImage(o.value,0,0,o.value.width,o.value.height,0,0,u,i),n.value.clearRect(0,0,o.value.width,o.value.height)}function z(u){u.target.innerText.split(/\n\r|\n/).forEach((g,S)=>{e.value.fillStyle=a.color,e.value.font='14px "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif';let P=d.value+9,A=y.value-14+(S+1)*20;e.value.fillText(g,P,A)}),u.target.innerText="",m.value=!1}function he(){e.value.clearRect(0,0,l.value.width,l.value.height),a.drawType=="eraser"&&r("paint")}return(u,i)=>{const g=be,S=Rt;return I(),D("div",Yt,[E("div",Kt,[N(g,{type:a.drawType=="paint"?"primary":"",onClick:i[0]||(i[0]=P=>r("paint"))},{default:W(()=>i[7]||(i[7]=[X(" 画笔 ")])),_:1},8,["type"]),N(g,{type:a.drawType=="rect"?"primary":"",onClick:i[1]||(i[1]=P=>r("rect"))},{default:W(()=>i[8]||(i[8]=[X(" 矩形 ")])),_:1},8,["type"]),N(g,{type:a.drawType=="ellipse"?"primary":"",onClick:i[2]||(i[2]=P=>r("ellipse"))},{default:W(()=>i[9]||(i[9]=[X(" 椭圆 ")])),_:1},8,["type"]),N(g,{type:a.drawType=="arrow"?"primary":"",onClick:i[3]||(i[3]=P=>r("arrow"))},{default:W(()=>i[10]||(i[10]=[X(" 箭头 ")])),_:1},8,["type"]),N(g,{type:a.drawType=="text"?"primary":"",onClick:i[4]||(i[4]=P=>r("text"))},{default:W(()=>i[11]||(i[11]=[X(" 文本 ")])),_:1},8,["type"]),N(S,{modelValue:a.color,"onUpdate:modelValue":i[5]||(i[5]=P=>a.color=P),predefine:f.value},null,8,["modelValue","predefine"]),N(g,{type:a.drawType=="eraser"?"primary":"",onClick:i[6]||(i[6]=P=>r("eraser"))},{default:W(()=>i[12]||(i[12]=[X(" 橡皮擦 ")])),_:1},8,["type"]),N(g,{style:{"margin-left":"36px"},type:"",onClick:he},{default:W(()=>i[13]||(i[13]=[X("清空")])),_:1})]),E("div",Ot,[E("canvas",{ref_key:"canvas",ref:l,class:"whiteboard-canvas",width:"",height:"",onMousedown:_,onMousemove:V,onMouseup:$,onMouseleave:$},null,544),ee(E("canvas",{ref_key:"canvasTemp",ref:o,class:"whiteboard-temp",width:"",height:"",onMousedown:_,onMousemove:V,onMouseup:$,onMouseleave:$},null,544),[[ce,["rect","ellipse","arrow"].includes(a.drawType)]]),ee(E("div",{ref_key:"inputRef",ref:k,class:"whiteboard-input",contenteditable:"true",style:O({color:a.color,left:p.value+"px",top:b.value-16+"px"}),onBlur:z},null,36),[[ce,a.drawType=="text"&&m.value]])])])}}};export{Zt as default};
