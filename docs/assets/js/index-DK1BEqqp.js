import{aF as we,b as ye,d as Q,ad as xe,i as ee,e as F,aG as te,aH as Ie,aI as Ce,v as Ee,u as he,aJ as Ne,r as h,aK as Re,aL as Le,f as E,w as ae,Y as Oe,y as Te,o as g,l as N,m as f,N as o,T as ze,A as m,s as _,k as e,n as ne,aM as Ve,Z as $e,X as w,E as I,aN as Se,j as A,$ as se,aO as Ae,a7 as Me,aP as Pe,aQ as Xe,p as Be,aR as Ye,aS as Fe,ao as De,aa as je,ab as He,q as qe,_ as Ge,L as $,Q as L,aT as Je,t as Ke,aE as Ue,ar as oe,aU as We,an as Ze,aq as Qe,R as et,al as T,ap as tt}from"./index-ZuzpkN-R.js";import{E as at}from"./index-1bu3Glpy.js";import{d as nt}from"./debounce-Cmdijbbl.js";import{_ as st}from"./plugin-vue_export-helper-DlAUqK2U.js";var ot="Expected a function";function Y(d,l,r){var a=!0,n=!0;if(typeof d!="function")throw new TypeError(ot);return we(r)&&(a="leading"in r?!!r.leading:a,n="trailing"in r?!!r.trailing:n),nt(d,l,{leading:a,maxWait:l,trailing:n})}const lt=ye({urlList:{type:Q(Array),default:()=>xe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Q(String)}}),rt={close:()=>!0,switch:d=>ee(d),rotate:d=>ee(d)},it=F({name:"ElImageViewer"}),ut=F({...it,props:lt,emits:rt,setup(d,{expose:l,emit:r}){var a;const n=d,p={CONTAIN:{name:"contain",icon:te(Ie)},ORIGINAL:{name:"original",icon:te(Ce)}},{t:M}=Ee(),i=he("image-viewer"),{nextZIndex:le}=Ne(),P=h(),D=h([]),j=Re(),R=h(!0),y=h(n.initialIndex),z=Le(p.CONTAIN),u=h({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),re=h((a=n.zIndex)!=null?a:le()),ie=E(()=>{const{urlList:t}=n;return t.length<=1}),H=E(()=>y.value===0),q=E(()=>y.value===n.urlList.length-1),ue=E(()=>n.urlList[y.value]),ce=E(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!n.infinite&&H.value)]),de=E(()=>[i.e("btn"),i.e("next"),i.is("disabled",!n.infinite&&q.value)]),fe=E(()=>{const{scale:t,deg:c,offsetX:s,offsetY:v,enableTransition:b}=u.value;let k=s/t,x=v/t;const O=c*Math.PI/180,W=Math.cos(O),Z=Math.sin(O);k=k*W+x*Z,x=x*W-s/t*Z;const B={transform:`scale(${t}) rotate(${c}deg) translate(${k}px, ${x}px)`,transition:b?"transform .3s":""};return z.value.name===p.CONTAIN.name&&(B.maxWidth=B.maxHeight="100%"),B});function V(){pe(),r("close")}function me(){const t=Y(s=>{switch(s.code){case L.esc:n.closeOnPressEscape&&V();break;case L.space:J();break;case L.left:K();break;case L.up:C("zoomIn");break;case L.right:U();break;case L.down:C("zoomOut");break}}),c=Y(s=>{const v=s.deltaY||s.deltaX;C(v<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});j.run(()=>{$(document,"keydown",t),$(document,"wheel",c)})}function pe(){j.stop()}function ve(){R.value=!1}function _e(t){R.value=!1,t.target.alt=M("el.image.error")}function ge(t){if(R.value||t.button!==0||!P.value)return;u.value.enableTransition=!1;const{offsetX:c,offsetY:s}=u.value,v=t.pageX,b=t.pageY,k=Y(O=>{u.value={...u.value,offsetX:c+O.pageX-v,offsetY:s+O.pageY-b}}),x=$(document,"mousemove",k);$(document,"mouseup",()=>{x()}),t.preventDefault()}function G(){u.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function J(){if(R.value)return;const t=Je(p),c=Object.values(p),s=z.value.name,b=(c.findIndex(k=>k.name===s)+1)%t.length;z.value=p[t[b]],G()}function X(t){const c=n.urlList.length;y.value=(t+c)%c}function K(){H.value&&!n.infinite||X(y.value-1)}function U(){q.value&&!n.infinite||X(y.value+1)}function C(t,c={}){if(R.value)return;const{minScale:s,maxScale:v}=n,{zoomRate:b,rotateDeg:k,enableTransition:x}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...c};switch(t){case"zoomOut":u.value.scale>s&&(u.value.scale=Number.parseFloat((u.value.scale/b).toFixed(3)));break;case"zoomIn":u.value.scale<v&&(u.value.scale=Number.parseFloat((u.value.scale*b).toFixed(3)));break;case"clockwise":u.value.deg+=k,r("rotate",u.value.deg);break;case"anticlockwise":u.value.deg-=k,r("rotate",u.value.deg);break}u.value.enableTransition=x}function be(t){var c;((c=t.detail)==null?void 0:c.focusReason)==="pointer"&&t.preventDefault()}function ke(){n.closeOnPressEscape&&V()}return ae(ue,()=>{Oe(()=>{const t=D.value[0];t!=null&&t.complete||(R.value=!0)})}),ae(y,t=>{G(),r("switch",t)}),Te(()=>{me()}),l({setActiveItem:X}),(t,c)=>(g(),N(e(at),{to:"body",disabled:!t.teleported},{default:f(()=>[o(ze,{name:"viewer-fade",appear:""},{default:f(()=>[m("div",{ref_key:"wrapper",ref:P,tabindex:-1,class:_(e(i).e("wrapper")),style:ne({zIndex:re.value})},[o(e(Ve),{loop:"",trapped:"","focus-trap-el":P.value,"focus-start-el":"container",onFocusoutPrevented:be,onReleaseRequested:ke},{default:f(()=>[m("div",{class:_(e(i).e("mask")),onClick:$e(s=>t.hideOnClickModal&&V(),["self"])},null,10,["onClick"]),w(" CLOSE "),m("span",{class:_([e(i).e("btn"),e(i).e("close")]),onClick:V},[o(e(I),null,{default:f(()=>[o(e(Se))]),_:1})],2),w(" ARROW "),e(ie)?w("v-if",!0):(g(),A(se,{key:0},[m("span",{class:_(e(ce)),onClick:K},[o(e(I),null,{default:f(()=>[o(e(Ae))]),_:1})],2),m("span",{class:_(e(de)),onClick:U},[o(e(I),null,{default:f(()=>[o(e(Me))]),_:1})],2)],64)),w(" ACTIONS "),m("div",{class:_([e(i).e("btn"),e(i).e("actions")])},[m("div",{class:_(e(i).e("actions__inner"))},[o(e(I),{onClick:s=>C("zoomOut")},{default:f(()=>[o(e(Pe))]),_:1},8,["onClick"]),o(e(I),{onClick:s=>C("zoomIn")},{default:f(()=>[o(e(Xe))]),_:1},8,["onClick"]),m("i",{class:_(e(i).e("actions__divider"))},null,2),o(e(I),{onClick:J},{default:f(()=>[(g(),N(Be(e(z).icon)))]),_:1}),m("i",{class:_(e(i).e("actions__divider"))},null,2),o(e(I),{onClick:s=>C("anticlockwise")},{default:f(()=>[o(e(Ye))]),_:1},8,["onClick"]),o(e(I),{onClick:s=>C("clockwise")},{default:f(()=>[o(e(Fe))]),_:1},8,["onClick"])],2)],2),w(" CANVAS "),m("div",{class:_(e(i).e("canvas"))},[(g(!0),A(se,null,De(t.urlList,(s,v)=>je((g(),A("img",{ref_for:!0,ref:b=>D.value[v]=b,key:s,src:s,style:ne(e(fe)),class:_(e(i).e("img")),crossorigin:t.crossorigin,onLoad:ve,onError:_e,onMousedown:ge},null,46,["src","crossorigin"])),[[He,v===y.value]])),128))],2),qe(t.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var ct=Ge(ut,[["__file","image-viewer.vue"]]);const dt=Ke(ct),ft=Ue.currentRoute,mt=oe();function S(d,l){var a,n;return l||(l=ft.value.name),!!(((n=(a=mt.menuObj[l])==null?void 0:a.meta)==null?void 0:n.buttons)||[]).some(p=>p==d)}const pt={__name:"ImgView",props:{modelValue:{type:Boolean,default:!1},urlList:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(d,{emit:l}){const r=l;return(a,n)=>{const p=dt;return d.modelValue?(g(),N(p,{key:0,"url-list":d.urlList,onClose:n[0]||(n[0]=M=>r("update:modelValue",!1))},null,8,["url-list"])):w("",!0)}}};function vt(d){const l=document.createElement("div");l.classList.add("img-viewer-box"),document.body.append(l);const r=We(pt,{modelValue:!0,urlList:d,"onUpdate:modelValue":a=>{a||(r.unmount(l),l.remove())}});r.mount(l)}const _t={class:"page-svg"},gt={class:"row-box"},bt={class:"row-box"},kt={class:"row-box"},wt=F({name:"BaseCase"}),yt=Object.assign(wt,{setup(d){Ze(),Qe(),oe();const l=h(["https://img2.baidu.com/it/u=2193238619,3962578777&fm=253&fmt=auto&app=120&f=JPEG?w=1067&h=800","https://img0.baidu.com/it/u=2099628,2438611947&fm=253&fmt=auto&app=138&f=JPEG?w=755&h=500"]);return(r,a)=>{const n=tt,p=et;return g(),A("div",_t,[m("div",gt,[a[1]||(a[1]=m("span",null,"svg-icon：",-1)),o(n,{name:"edit"})]),m("div",bt,[a[6]||(a[6]=m("span",null,"按钮权限：",-1)),e(S)("add")?(g(),N(p,{key:0,type:"primary"},{default:f(()=>a[2]||(a[2]=[T("新增")])),_:1})):w("",!0),e(S)("edit")?(g(),N(p,{key:1,type:"primary"},{default:f(()=>a[3]||(a[3]=[T("编辑")])),_:1})):w("",!0),e(S)("delete")?(g(),N(p,{key:2,type:"primary"},{default:f(()=>a[4]||(a[4]=[T("删除")])),_:1})):w("",!0),e(S)("export")?(g(),N(p,{key:3,type:"primary"},{default:f(()=>a[5]||(a[5]=[T("导出")])),_:1})):w("",!0)]),m("div",kt,[a[8]||(a[8]=m("span",null,"图片预览：",-1)),o(p,{type:"primary",onClick:a[0]||(a[0]=M=>e(vt)(l.value))},{default:f(()=>a[7]||(a[7]=[T("预览")])),_:1})])])}}}),ht=st(yt,[["__scopeId","data-v-01ab2331"]]);export{ht as default};
