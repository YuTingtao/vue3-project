import{b3 as f}from"./vendor-CVQhdJei.js";import{u as r,r as u}from"./index-CHmf0HnN.js";import{q as l}from"./vendor-element-BdTuGaye.js";function o(t){l.error({message:t,duration:2e3,grouping:!0})}function i(){const t=u.currentRoute;let e="/login";t.value.path!="/login"&&(e=`/login?redirect=${t.value.fullPath}`),u.push(e)}const n=f.create({baseURL:"/",timeout:void 0});n.interceptors.request.use(t=>{const e=r();return t.headers["Content-Type"]="application/json",e.token&&(t.headers.token=e.token),t},t=>Promise.reject(t));n.interceptors.response.use(t=>{const e=r();return t.status===200?t.data instanceof Blob||t.data instanceof ArrayBuffer?t:(t.data.code!==200&&o(t.data.msg),t.data.code===401&&(e.setLogout(),i()),t.data):Promise.reject(t.data)},t=>{var a,s;if((s=(a=t.config)==null?void 0:a.signal)!=null&&s.aborted)return;const e=r();if(t.response)switch(t.response.status){case 401:o("登录过期，请重新登录"),e.setLogout(),i();break;case 404:o("接口地址不存在");break;default:o("服务器异常")}else navigator.onLine||o("网络异常，请检查您的网络");return Promise.reject(t)});function c(t){return n.request(t)}function m(t){return c({url:"/api/user/login",method:"post",data:t})}function h(){return c({url:"/api/user/logout",method:"get",timeout:500})}export{m as a,h as l};
