import{a as i}from"./axios-B4uVmeYG.js";import{u as n,r as a}from"./index-Dx-eSvI_.js";import{q as s}from"./element-plus-BFcDWg1f.js";function o(t){s.closeAll(),s.error({message:t,duration:2e3})}function u(){const t=a.currentRoute;let e="/login";t.value.path!="/login"&&(e=`/login?redirect=${t.value.fullPath}`),a.push(e)}const r=i.create({});r.interceptors.request.use(t=>{const e=n();return t.headers["Content-Type"]="application/json",e.token&&(t.headers.token=e.token),t},t=>Promise.reject(t));r.interceptors.response.use(t=>{const e=n();return t.status>=200&&t.status<300?t.data instanceof Blob||t.data instanceof ArrayBuffer?t:(t.data.code!="200"&&o(t.data.msg),t.data.code=="000001"&&(e.setLogout(),u()),t.data):Promise.reject(t)},t=>{if(t.response){switch(t.response.status){case 404:o("网络请求不存在");break;default:o("网络请求错误")}return Promise.reject(t)}else navigator.onLine||o("网络已断开，请检查网络")});const f={login(t){return r.request({url:"/api/login",method:"post",data:t,timeout:500})},logout(){return r.request({url:"/api/logout",method:"get"})}};export{f as l};
